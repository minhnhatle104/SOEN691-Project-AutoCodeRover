[
    {
        "role": "system",
        "content": "You are a software developer maintaining a large project.\nYou are working on an issue submitted to your project.\nThe issue contains a description marked between <issue> and </issue>.\nYour task is to invoke a few search API calls to gather buggy information, then write patches to solve the issues.\n"
    },
    {
        "role": "user",
        "content": "<issue>[Bug]: Constrained layout UserWarning even when False\n### Bug summary\nWhen using layout settings such as `plt.subplots_adjust` or `bbox_inches='tight`, a UserWarning is produced due to incompatibility with constrained_layout, even if constrained_layout = False. This was not the case in previous versions.\n### Code for reproduction\n```python\nimport matplotlib.pyplot as plt\nimport numpy as np\na = np.linspace(0,2*np.pi,100)\nb = np.sin(a)\nc = np.cos(a)\nfig,ax = plt.subplots(1,2,figsize=(8,2),constrained_layout=False)\nax[0].plot(a,b)\nax[1].plot(a,c)\nplt.subplots_adjust(wspace=0)\n```\n### Actual outcome\nThe plot works fine but the warning is generated\n`/var/folders/ss/pfgdfm2x7_s4cyw2v0b_t7q80000gn/T/ipykernel_76923/4170965423.py:7: UserWarning: This figure was using a layout engine that is incompatible with subplots_adjust and/or tight_layout; not calling subplots_adjust.\nplt.subplots_adjust(wspace=0)`\n### Expected outcome\nno warning\n### Additional information\nWarning disappears when constrained_layout=False is removed\n### Operating system\nOS/X\n### Matplotlib Version\n3.6.0\n### Matplotlib Backend\n_No response_\n### Python version\n_No response_\n### Jupyter version\n_No response_\n### Installation\nconda\n</issue>"
    },
    {
        "role": "user",
        "content": "An external analysis tool has been deployed to identify the suspicious code to be fixed. You can choose to use the results from this tool, if you think they are useful.The tool output is as follows:\nLocalization could not produce any output."
    },
    {
        "role": "user",
        "content": "Based on the files, classes, methods, code statements from the issue that related to the bug, you can use below search APIs to get more context of the project.\n        search_class(class_name: str): Search for a class in the codebase.\n        search_method_in_file(method_name: str, file_path: str): Search for a method in a given file.\n        search_method_in_class(method_name: str, class_name: str): Search for a method in a given class.\n        search_method(method_name: str): Search for a method in the entire codebase.\n        search_code(code_str: str): Search for a code snippet in the entire codebase.\n        search_code_in_file(code_str: str, file_path: str): Search for a code snippet in a given file file.\n        Note that you can use multiple search APIs in one round.\n        Now analyze the issue and select necessary APIs to get more context of the project, each API call must have concrete arguments as inputs.\n        "
    },
    {
        "role": "assistant",
        "content": "To address the issue effectively, we need to understand how `constrained_layout` is handled within the Matplotlib codebase, especially in relation to `plt.subplots_adjust` and the generation of warnings. Given the information in the issue, the following API calls would be beneficial:\n\n1. Search for the method that handles `plt.subplots_adjust` to understand how it interacts with `constrained_layout` settings.\n2. Search for the method or code snippet that generates the UserWarning mentioned in the issue to understand under what conditions it is triggered.\n3. Since the issue mentions that the warning is related to the use of `constrained_layout=False`, it would be useful to search for code snippets where `constrained_layout` is checked or modified.\n\nTherefore, the API calls I would like to make are:\n\n- `search_method(\"subplots_adjust\")`\n- `search_code(\"UserWarning\")`\n- `search_code(\"constrained_layout\")`"
    },
    {
        "role": "user",
        "content": "Result of search_method(\"subplots_adjust\"):\nFound 2 methods with name subplots_adjust in the codebase.\nSearch result 1: <file>lib/matplotlib/pyplot.py</file> <func>subplots_adjust</func> <code>def subplots_adjust(\n        left=None, bottom=None, right=None, top=None, wspace=None,\n        hspace=None):\n    return gcf().subplots_adjust(\n        left=left, bottom=bottom, right=right, top=top, wspace=wspace,\n        hspace=hspace)\n</code>\n\nSearch result 2: <file>lib/matplotlib/figure.py</file> <class>FigureBase</class> <func>subplots_adjust</func> <code>    def subplots_adjust(self, left=None, bottom=None, right=None, top=None,\n                        wspace=None, hspace=None):\n        \"\"\"\n        Adjust the subplot layout parameters.\n\n        Unset parameters are left unmodified; initial values are given by\n        :rc:`figure.subplot.[name]`.\n\n        Parameters\n        ----------\n        left : float, optional\n            The position of the left edge of the subplots,\n            as a fraction of the figure width.\n        right : float, optional\n            The position of the right edge of the subplots,\n            as a fraction of the figure width.\n        bottom : float, optional\n            The position of the bottom edge of the subplots,\n            as a fraction of the figure height.\n        top : float, optional\n            The position of the top edge of the subplots,\n            as a fraction of the figure height.\n        wspace : float, optional\n            The width of the padding between subplots,\n            as a fraction of the average Axes width.\n        hspace : float, optional\n            The height of the padding between subplots,\n            as a fraction of the average Axes height.\n        \"\"\"\n        if (self.get_layout_engine() is not None and\n                not self.get_layout_engine().adjust_compatible):\n            _api.warn_external(\n                \"This figure was using a layout engine that is \"\n                \"incompatible with subplots_adjust and/or tight_layout; \"\n                \"not calling subplots_adjust.\")\n            return\n        self.subplotpars.update(left, bottom, right, top, wspace, hspace)\n        for ax in self.axes:\n            if hasattr(ax, 'get_subplotspec'):\n                ax._set_position(ax.get_subplotspec().get_position(self))\n        self.stale = True\n</code>\n\n\n\nResult of search_code(\"UserWarning\"):\nFound 61 snippets containing `UserWarning` in the codebase.\nThey appeared in the following files:\n<file>examples/subplots_axes_and_figures/demo_tight_layout.py</file> (1 matches)\n<file>lib/mpl_toolkits/tests/test_axes_grid1.py</file> (2 matches)\n<file>lib/matplotlib/tests/test_cbook.py</file> (1 matches)\n<file>lib/matplotlib/tests/test_tightlayout.py</file> (5 matches)\n<file>lib/matplotlib/tests/test_triangulation.py</file> (2 matches)\n<file>lib/matplotlib/tests/test_image.py</file> (3 matches)\n<file>lib/matplotlib/tests/test_colors.py</file> (1 matches)\n<file>lib/matplotlib/tests/test_animation.py</file> (3 matches)\n<file>lib/matplotlib/tests/test_rcparams.py</file> (2 matches)\n<file>lib/matplotlib/tests/test_dates.py</file> (2 matches)\n<file>lib/matplotlib/tests/test_patches.py</file> (1 matches)\n<file>lib/matplotlib/tests/test_scale.py</file> (4 matches)\n<file>lib/matplotlib/tests/test_ticker.py</file> (4 matches)\n<file>lib/matplotlib/tests/test_text.py</file> (2 matches)\n<file>lib/matplotlib/tests/test_figure.py</file> (3 matches)\n<file>lib/matplotlib/tests/test_axes.py</file> (7 matches)\n<file>lib/matplotlib/tests/test_mlab.py</file> (1 matches)\n<file>lib/matplotlib/tests/test_backend_bases.py</file> (3 matches)\n<file>lib/matplotlib/tests/test_constrainedlayout.py</file> (1 matches)\n<file>lib/matplotlib/tests/test_contour.py</file> (3 matches)\n<file>lib/matplotlib/tests/test_backends_interactive.py</file> (1 matches)\n<file>lib/matplotlib/tests/test_backend_pdf.py</file> (4 matches)\n<file>lib/matplotlib/tests/test_legend.py</file> (5 matches)\n\n\nResult of search_code(\"constrained_layout\"):\nFound 290 snippets containing `constrained_layout` in the codebase.\nThey appeared in the following files:\n<file>tutorials/provisional/mosaic.py</file> (14 matches)\n<file>tutorials/colors/colormapnorms.py</file> (2 matches)\n<file>tutorials/colors/colormap-manipulation.py</file> (2 matches)\n<file>tutorials/text/annotations.py</file> (1 matches)\n<file>tutorials/intermediate/constrainedlayout_guide.py</file> (33 matches)\n<file>tutorials/intermediate/tight_layout_guide.py</file> (1 matches)\n<file>tutorials/intermediate/arranging_axes.py</file> (2 matches)\n<file>examples/subplots_axes_and_figures/axes_box_aspect.py</file> (3 matches)\n<file>examples/subplots_axes_and_figures/secondary_axis.py</file> (4 matches)\n<file>examples/subplots_axes_and_figures/subfigures.py</file> (4 matches)\n<file>examples/subplots_axes_and_figures/gridspec_multicolumn.py</file> (1 matches)\n<file>examples/subplots_axes_and_figures/demo_constrained_layout.py</file> (5 matches)\n<file>examples/subplots_axes_and_figures/colorbar_placement.py</file> (4 matches)\n<file>examples/subplots_axes_and_figures/figure_title.py</file> (2 matches)\n<file>examples/lines_bars_and_markers/scatter_hist.py</file> (1 matches)\n<file>examples/lines_bars_and_markers/timeline.py</file> (1 matches)\n<file>examples/lines_bars_and_markers/psd_demo.py</file> (2 matches)\n<file>examples/lines_bars_and_markers/markevery_demo.py</file> (4 matches)\n<file>examples/lines_bars_and_markers/curve_error_band.py</file> (1 matches)\n<file>examples/style_sheets/style_sheets_reference.py</file> (1 matches)\n<file>examples/units/units_sample.py</file> (1 matches)\n<file>examples/widgets/rectangle_selector.py</file> (1 matches)\n<file>examples/images_contours_and_fields/pcolormesh_grids.py</file> (2 matches)\n<file>examples/images_contours_and_fields/image_nonuniform.py</file> (1 matches)\n<file>examples/images_contours_and_fields/contourf_demo.py</file> (3 matches)\n<file>examples/images_contours_and_fields/image_antialiasing.py</file> (2 matches)\n<file>examples/axisartist/simple_axisartist1.py</file> (1 matches)\n<file>examples/text_labels_and_annotations/label_subplots.py</file> (3 matches)\n<file>examples/text_labels_and_annotations/legend_demo.py</file> (2 matches)\n<file>examples/text_labels_and_annotations/date.py</file> (1 matches)\n<file>examples/text_labels_and_annotations/titles_demo.py</file> (2 matches)\n<file>examples/text_labels_and_annotations/arrow_demo.py</file> (1 matches)\n<file>examples/ticks/date_index_formatter.py</file> (1 matches)\n<file>examples/ticks/date_concise_formatter.py</file> (5 matches)\n<file>examples/ticks/ticks_too_many.py</file> (2 matches)\n<file>examples/ticks/date_precision_and_epochs.py</file> (2 matches)\n<file>examples/misc/rasterization_demo.py</file> (1 matches)\n<file>examples/user_interfaces/gtk4_spreadsheet_sgskip.py</file> (1 matches)\n<file>examples/shapes_and_collections/hatch_style_reference.py</file> (3 matches)\n<file>examples/scales/asinh_demo.py</file> (1 matches)\n<file>examples/scales/scales.py</file> (1 matches)\n<file>examples/statistics/barchart_demo.py</file> (1 matches)\n<file>examples/statistics/time_series_histogram.py</file> (1 matches)\n<file>examples/spines/spines.py</file> (1 matches)\n<file>examples/userdemo/connectionstyle_demo.py</file> (2 matches)\n<file>lib/mpl_toolkits/tests/test_mplot3d.py</file> (2 matches)\n<file>lib/matplotlib/_constrained_layout.py</file> (8 matches)\n<file>lib/matplotlib/dates.py</file> (1 matches)\n<file>lib/matplotlib/colorbar.py</file> (1 matches)\n<file>lib/matplotlib/layout_engine.py</file> (19 matches)\n<file>lib/matplotlib/_layoutgrid.py</file> (1 matches)\n<file>lib/matplotlib/figure.py</file> (38 matches)\n<file>lib/matplotlib/patches.py</file> (1 matches)\n<file>lib/matplotlib/_enums.py</file> (1 matches)\n<file>lib/matplotlib/rcsetup.py</file> (6 matches)\n<file>lib/matplotlib/axis.py</file> (1 matches)\n<file>lib/matplotlib/gridspec.py</file> (1 matches)\n<file>lib/matplotlib/tests/test_colorbar.py</file> (5 matches)\n<file>lib/matplotlib/tests/test_image.py</file> (1 matches)\n<file>lib/matplotlib/tests/test_text.py</file> (1 matches)\n<file>lib/matplotlib/tests/test_figure.py</file> (8 matches)\n<file>lib/matplotlib/tests/test_axes.py</file> (3 matches)\n<file>lib/matplotlib/tests/test_backend_bases.py</file> (2 matches)\n<file>lib/matplotlib/tests/test_constrainedlayout.py</file> (57 matches)\n<file>lib/matplotlib/axes/_secondary_axes.py</file> (1 matches)\n<file>lib/matplotlib/axes/_base.py</file> (2 matches)\n\n\n"
    },
    {
        "role": "user",
        "content": "Let's analyze collected context first"
    },
    {
        "role": "assistant",
        "content": "Based on the collected context from the search API calls, we can draw several conclusions and identify potential areas to investigate further for fixing the issue:\n\n1. **`subplots_adjust` Method Context**:\n   - The `subplots_adjust` method is defined in two places: `lib/matplotlib/pyplot.py` and `lib/matplotlib/figure.py`. The implementation in `pyplot.py` is a wrapper that calls `subplots_adjust` on the current figure, which is defined in `figure.py`.\n   - The `subplots_adjust` method in `figure.py` contains a check for whether the figure is using a layout engine that is incompatible with `subplots_adjust` and/or `tight_layout`. If such a layout engine is in use and it's not compatible with adjustments, a `UserWarning` is issued, and the method returns early without applying the adjustments.\n\n2. **UserWarning Context**:\n   - The specific `UserWarning` mentioned in the issue is generated within the `subplots_adjust` method in `figure.py` when there's an incompatibility with the layout engine being used. This aligns with the issue description, where the warning is triggered even when `constrained_layout=False`.\n\n3. **`constrained_layout` Usage Context**:\n   - The term `constrained_layout` appears extensively across the codebase, indicating its significant impact on layout management in Matplotlib. Notably, it is mentioned in `lib/matplotlib/figure.py`, `lib/matplotlib/layout_engine.py`, and `lib/matplotlib/tests/test_constrainedlayout.py`, among others.\n   - This widespread usage suggests that any changes related to `constrained_layout` handling need to be carefully considered to avoid unintended side effects.\n\n**Analysis**:\nThe issue arises from the `subplots_adjust` method's early return when an incompatible layout engine is detected. This behavior is intended to prevent layout adjustments that could conflict with the layout engine's operation. However, the warning is generated even when `constrained_layout` is explicitly set to `False`, which seems to be an oversight or a bug.\n\n**Next Steps**:\n- Investigate how `constrained_layout=False` is handled and why it doesn't prevent the layout engine from being considered incompatible with `subplots_adjust`.\n- Review the logic within `FigureBase.subplots_adjust` in `figure.py` to understand how the compatibility check is performed and how `constrained_layout=False` should influence this check.\n- It may be necessary to adjust the compatibility check or the way `constrained_layout` settings are interpreted to ensure that the warning is only generated when appropriate.\n\nGiven the information at hand, the next step would involve diving into the implementation details within `figure.py`, particularly how `constrained_layout` settings are managed and how they interact with the layout engine's compatibility check."
    },
    {
        "role": "user",
        "content": "Based on your analysis, answer below questions:  - do we need more context: construct search API calls to get more context of the project. (leave it empty if you don't need more context)  - where are bug locations: buggy files and methods. (leave it empty if you don't have enough information)"
    },
    {
        "role": "assistant",
        "content": "- do we need more context: \n\n- where are bug locations: \n  - **Buggy File**: `lib/matplotlib/figure.py`\n  - **Buggy Method**: `FigureBase.subplots_adjust`"
    },
    {
        "role": "user",
        "content": "The buggy locations is not precise. You may need to check whether the arguments are correct and search more information."
    },
    {
        "role": "assistant",
        "content": "Given the feedback, it seems necessary to refine our understanding of how `constrained_layout` is managed and interacts with the layout engine, particularly in the context of `subplots_adjust`. To get a more precise location of the bug and understand the handling of `constrained_layout` in greater detail, the following additional context would be beneficial:\n\n1. Investigate how the layout engine is determined and its compatibility with `subplots_adjust` and `tight_layout` is assessed. This requires looking into the method that sets or gets the layout engine for a figure.\n2. Understand the implementation details of `constrained_layout` to see if there's a specific condition or oversight that leads to the warning being issued even when `constrained_layout=False`.\n\nTherefore, the additional API calls I would like to make are:\n\n- `search_method_in_class(\"get_layout_engine\", \"FigureBase\")`\n- `search_code_in_file(\"constrained_layout\", \"lib/matplotlib/figure.py\")`\n\nThese searches aim to provide a deeper insight into the handling of the layout engine and `constrained_layout` setting, which should help in pinpointing the bug's location more precisely."
    },
    {
        "role": "user",
        "content": "Result of search_method_in_class(\"get_layout_engine\", \"FigureBase\"):\nCould not find method get_layout_engine in class FigureBase`.\n\nResult of search_code_in_file(\"constrained_layout\", \"lib/matplotlib/figure.py\"):\nFound 38 snippets with code constrained_layout in file lib/matplotlib/figure.py.\nThey appeared in the following methods:\n<file>lib/matplotlib/figure.py</file> <func>get_constrained_layout</func> (3 matches)\n<file>lib/matplotlib/figure.py</file> <func>get_constrained_layout_pads</func> (6 matches)\n<file>lib/matplotlib/figure.py</file> <func>__init__</func> (13 matches)\n<file>lib/matplotlib/figure.py</file> <func>set_layout_engine</func> (2 matches)\n<file>lib/matplotlib/figure.py</file> <func>set_constrained_layout</func> (5 matches)\n<file>lib/matplotlib/figure.py</file> <func>set_constrained_layout_pads</func> (7 matches)\n<file>lib/matplotlib/figure.py</file> <func>execute_constrained_layout</func> (2 matches)\n\n\n"
    },
    {
        "role": "user",
        "content": "Let's analyze collected context first"
    },
    {
        "role": "assistant",
        "content": "Based on the additional context provided by the search results, we can refine our understanding of how `constrained_layout` is managed within the Matplotlib codebase, specifically within `lib/matplotlib/figure.py`. Here's a breakdown of the relevant findings:\n\n1. **Absence of `get_layout_engine` Method**:\n   - The search did not find a method named `get_layout_engine` in the `FigureBase` class. This suggests that the handling or retrieval of the layout engine might not be as straightforward as initially thought, or it's managed differently than anticipated.\n\n2. **Relevant Methods in `figure.py`**:\n   - Several methods within `figure.py` deal directly with `constrained_layout`, including getters, setters, and execution methods. This indicates that the management and application of `constrained_layout` settings are centralized in this file.\n\n3. **Key Methods**:\n   - `get_constrained_layout` and `set_constrained_layout` are direct getters and setters for the `constrained_layout` property, indicating where the `constrained_layout` flag's state is accessed and modified.\n   - `set_layout_engine` suggests that there is a method dedicated to setting the layout engine, which might be where the compatibility with `constrained_layout` is determined or influenced.\n   - `execute_constrained_layout` likely handles the actual application of the constrained layout logic based on the current settings.\n\n**Analysis**:\nGiven that the warning mentioned in the issue is related to the incompatibility between `constrained_layout` and `subplots_adjust`, the bug likely resides in how the compatibility check is performed or how the `constrained_layout` setting is interpreted within these contexts. The absence of a straightforward `get_layout_engine` method means that the compatibility check or warning might be tied to how `constrained_layout` is set or executed rather than directly querying a layout engine property.\n\nThe initial analysis pointed towards `FigureBase.subplots_adjust` as a potential location for the bug due to the warning generation logic. However, with the new context, it's clear that understanding the interaction between `constrained_layout` settings (via `set_constrained_layout` and related methods) and the layout engine (potentially influenced by `set_layout_engine`) is crucial.\n\n**Conclusion**:\nThe bug is likely related to how `constrained_layout=False` is handled in the context of layout adjustments and the layout engine's compatibility. Specifically, the methods `set_constrained_layout`, `set_layout_engine`, and possibly `__init__` (where initial settings are applied) in `lib/matplotlib/figure.py` should be scrutinized to ensure that disabling `constrained_layout` correctly influences layout adjustment behavior and warning generation.\n\n**Next Steps**:\n- Review the implementation of `set_constrained_layout`, `set_layout_engine`, and `__init__` in `figure.py` to understand how `constrained_layout=False` is supposed to suppress the warning and why it might not be doing so.\n- Ensure that the logic for issuing warnings takes into account the explicit setting of `constrained_layout=False` and does not issue warnings when this layout is intentionally disabled."
    },
    {
        "role": "user",
        "content": "Based on your analysis, answer below questions:  - do we need more context: construct search API calls to get more context of the project. (leave it empty if you don't need more context)  - where are bug locations: buggy files and methods. (leave it empty if you don't have enough information)"
    },
    {
        "role": "assistant",
        "content": "- do we need more context: \n\n- where are bug locations: \n  - **Buggy File**: `lib/matplotlib/figure.py`\n  - **Buggy Methods**:\n    - `__init__`\n    - `set_constrained_layout`\n    - `set_layout_engine`"
    },
    {
        "role": "user",
        "content": "Here are the code in buggy locations:\nFound 5 methods with name `__init__` in file lib/matplotlib/figure.py.\nSearch result 1: <file>lib/matplotlib/figure.py</file> <class>_AxesStack</class> <func>__init__</func> <code>    def __init__(self):\n        self._axes = {}  # Mapping of axes to \"gca\" order.\n        self._counter = itertools.count()\n</code>\n\nSearch result 2: <file>lib/matplotlib/figure.py</file> <class>SubplotParams</class> <func>__init__</func> <code>    def __init__(self, left=None, bottom=None, right=None, top=None,\n                 wspace=None, hspace=None):\n        \"\"\"\n        Defaults are given by :rc:`figure.subplot.[name]`.\n\n        Parameters\n        ----------\n        left : float\n            The position of the left edge of the subplots,\n            as a fraction of the figure width.\n        right : float\n            The position of the right edge of the subplots,\n            as a fraction of the figure width.\n        bottom : float\n            The position of the bottom edge of the subplots,\n            as a fraction of the figure height.\n        top : float\n            The position of the top edge of the subplots,\n            as a fraction of the figure height.\n        wspace : float\n            The width of the padding between subplots,\n            as a fraction of the average Axes width.\n        hspace : float\n            The height of the padding between subplots,\n            as a fraction of the average Axes height.\n        \"\"\"\n        self._validate = True\n        for key in [\"left\", \"bottom\", \"right\", \"top\", \"wspace\", \"hspace\"]:\n            setattr(self, key, mpl.rcParams[f\"figure.subplot.{key}\"])\n        self.update(left, bottom, right, top, wspace, hspace)\n</code>\n\nSearch result 3: <file>lib/matplotlib/figure.py</file> <class>FigureBase</class> <func>__init__</func> <code>    def __init__(self, **kwargs):\n        super().__init__()\n        # remove the non-figure artist _axes property\n        # as it makes no sense for a figure to be _in_ an Axes\n        # this is used by the property methods in the artist base class\n        # which are over-ridden in this class\n        del self._axes\n\n        self._suptitle = None\n        self._supxlabel = None\n        self._supylabel = None\n\n        # groupers to keep track of x and y labels we want to align.\n        # see self.align_xlabels and self.align_ylabels and\n        # axis._get_tick_boxes_siblings\n        self._align_label_groups = {\"x\": cbook.Grouper(), \"y\": cbook.Grouper()}\n\n        self.figure = self\n        self._localaxes = []  # track all axes\n        self.artists = []\n        self.lines = []\n        self.patches = []\n        self.texts = []\n        self.images = []\n        self.legends = []\n        self.subfigs = []\n        self.stale = True\n        self.suppressComposite = None\n        self.set(**kwargs)\n</code>\n\nSearch result 4: <file>lib/matplotlib/figure.py</file> <class>SubFigure</class> <func>__init__</func> <code>    def __init__(self, parent, subplotspec, *,\n                 facecolor=None,\n                 edgecolor=None,\n                 linewidth=0.0,\n                 frameon=None,\n                 **kwargs):\n        \"\"\"\n        Parameters\n        ----------\n        parent : `.Figure` or `.SubFigure`\n            Figure or subfigure that contains the SubFigure.  SubFigures\n            can be nested.\n\n        subplotspec : `.gridspec.SubplotSpec`\n            Defines the region in a parent gridspec where the subfigure will\n            be placed.\n\n        facecolor : default: :rc:`figure.facecolor`\n            The figure patch face color.\n\n        edgecolor : default: :rc:`figure.edgecolor`\n            The figure patch edge color.\n\n        linewidth : float\n            The linewidth of the frame (i.e. the edge linewidth of the figure\n            patch).\n\n        frameon : bool, default: :rc:`figure.frameon`\n            If ``False``, suppress drawing the figure background patch.\n\n        Other Parameters\n        ----------------\n        **kwargs : `.SubFigure` properties, optional\n\n            %(SubFigure:kwdoc)s\n        \"\"\"\n        super().__init__(**kwargs)\n        if facecolor is None:\n            facecolor = mpl.rcParams['figure.facecolor']\n        if edgecolor is None:\n            edgecolor = mpl.rcParams['figure.edgecolor']\n        if frameon is None:\n            frameon = mpl.rcParams['figure.frameon']\n\n        self._subplotspec = subplotspec\n        self._parent = parent\n        self.figure = parent.figure\n        self._fig_callbacks = parent._fig_callbacks\n\n        # subfigures use the parent axstack\n        self._axstack = parent._axstack\n        self.subplotpars = parent.subplotpars\n        self.dpi_scale_trans = parent.dpi_scale_trans\n        self._axobservers = parent._axobservers\n        self.canvas = parent.canvas\n        self.transFigure = parent.transFigure\n        self.bbox_relative = None\n        self._redo_transform_rel_fig()\n        self.figbbox = self._parent.figbbox\n        self.bbox = TransformedBbox(self.bbox_relative,\n                                    self._parent.transSubfigure)\n        self.transSubfigure = BboxTransformTo(self.bbox)\n\n        self.patch = Rectangle(\n            xy=(0, 0), width=1, height=1, visible=frameon,\n            facecolor=facecolor, edgecolor=edgecolor, linewidth=linewidth,\n            # Don't let the figure patch influence bbox calculation.\n            in_layout=False, transform=self.transSubfigure)\n        self._set_artist_props(self.patch)\n        self.patch.set_antialiased(False)\n</code>\n\nSearch result 5: <file>lib/matplotlib/figure.py</file> <class>Figure</class> <func>__init__</func> <code>    def __init__(self,\n                 figsize=None,\n                 dpi=None,\n                 facecolor=None,\n                 edgecolor=None,\n                 linewidth=0.0,\n                 frameon=None,\n                 subplotpars=None,  # rc figure.subplot.*\n                 tight_layout=None,  # rc figure.autolayout\n                 constrained_layout=None,  # rc figure.constrained_layout.use\n                 *,\n                 layout=None,\n                 **kwargs\n                 ):\n        \"\"\"\n        Parameters\n        ----------\n        figsize : 2-tuple of floats, default: :rc:`figure.figsize`\n            Figure dimension ``(width, height)`` in inches.\n\n        dpi : float, default: :rc:`figure.dpi`\n            Dots per inch.\n\n        facecolor : default: :rc:`figure.facecolor`\n            The figure patch facecolor.\n\n        edgecolor : default: :rc:`figure.edgecolor`\n            The figure patch edge color.\n\n        linewidth : float\n            The linewidth of the frame (i.e. the edge linewidth of the figure\n            patch).\n\n        frameon : bool, default: :rc:`figure.frameon`\n            If ``False``, suppress drawing the figure background patch.\n\n        subplotpars : `SubplotParams`\n            Subplot parameters. If not given, the default subplot\n            parameters :rc:`figure.subplot.*` are used.\n\n        tight_layout : bool or dict, default: :rc:`figure.autolayout`\n            Whether to use the tight layout mechanism. See `.set_tight_layout`.\n\n            .. admonition:: Discouraged\n\n                The use of this parameter is discouraged. Please use\n                ``layout='tight'`` instead for the common case of\n                ``tight_layout=True`` and use `.set_tight_layout` otherwise.\n\n        constrained_layout : bool, default: :rc:`figure.constrained_layout.use`\n            This is equal to ``layout='constrained'``.\n\n            .. admonition:: Discouraged\n\n                The use of this parameter is discouraged. Please use\n                ``layout='constrained'`` instead.\n\n        layout : {'constrained', 'compressed', 'tight', `.LayoutEngine`, None}\n            The layout mechanism for positioning of plot elements to avoid\n            overlapping Axes decorations (labels, ticks, etc). Note that\n            layout managers can have significant performance penalties.\n            Defaults to *None*.\n\n            - 'constrained': The constrained layout solver adjusts axes sizes\n               to avoid overlapping axes decorations.  Can handle complex plot\n               layouts and colorbars, and is thus recommended.\n\n              See :doc:`/tutorials/intermediate/constrainedlayout_guide`\n              for examples.\n\n            - 'compressed': uses the same algorithm as 'constrained', but\n              removes extra space between fixed-aspect-ratio Axes.  Best for\n              simple grids of axes.\n\n            - 'tight': Use the tight layout mechanism. This is a relatively\n              simple algorithm that adjusts the subplot parameters so that\n              decorations do not overlap. See `.Figure.set_tight_layout` for\n              further details.\n\n            - A `.LayoutEngine` instance. Builtin layout classes are\n              `.ConstrainedLayoutEngine` and `.TightLayoutEngine`, more easily\n              accessible by 'constrained' and 'tight'.  Passing an instance\n              allows third parties to provide their own layout engine.\n\n            If not given, fall back to using the parameters *tight_layout* and\n            *constrained_layout*, including their config defaults\n            :rc:`figure.autolayout` and :rc:`figure.constrained_layout.use`.\n\n        Other Parameters\n        ----------------\n        **kwargs : `.Figure` properties, optional\n\n            %(Figure:kwdoc)s\n        \"\"\"\n        super().__init__(**kwargs)\n        self._layout_engine = None\n\n        if layout is not None:\n            if (tight_layout is not None):\n                _api.warn_external(\n                    \"The Figure parameters 'layout' and 'tight_layout' cannot \"\n                    \"be used together. Please use 'layout' only.\")\n            if (constrained_layout is not None):\n                _api.warn_external(\n                    \"The Figure parameters 'layout' and 'constrained_layout' \"\n                    \"cannot be used together. Please use 'layout' only.\")\n            self.set_layout_engine(layout=layout)\n        elif tight_layout is not None:\n            if constrained_layout is not None:\n                _api.warn_external(\n                    \"The Figure parameters 'tight_layout' and \"\n                    \"'constrained_layout' cannot be used together. Please use \"\n                    \"'layout' parameter\")\n            self.set_layout_engine(layout='tight')\n            if isinstance(tight_layout, dict):\n                self.get_layout_engine().set(**tight_layout)\n        elif constrained_layout is not None:\n            self.set_layout_engine(layout='constrained')\n            if isinstance(constrained_layout, dict):\n                self.get_layout_engine().set(**constrained_layout)\n        else:\n            # everything is None, so use default:\n            self.set_layout_engine(layout=layout)\n\n        self._fig_callbacks = cbook.CallbackRegistry(signals=[\"dpi_changed\"])\n        # Callbacks traditionally associated with the canvas (and exposed with\n        # a proxy property), but that actually need to be on the figure for\n        # pickling.\n        self._canvas_callbacks = cbook.CallbackRegistry(\n            signals=FigureCanvasBase.events)\n        self._button_pick_id = self._canvas_callbacks._connect_picklable(\n            'button_press_event', self.pick)\n        self._scroll_pick_id = self._canvas_callbacks._connect_picklable(\n            'scroll_event', self.pick)\n        connect = self._canvas_callbacks._connect_picklable\n        self._mouse_key_ids = [\n            connect('key_press_event', backend_bases._key_handler),\n            connect('key_release_event', backend_bases._key_handler),\n            connect('key_release_event', backend_bases._key_handler),\n            connect('button_press_event', backend_bases._mouse_handler),\n            connect('button_release_event', backend_bases._mouse_handler),\n            connect('scroll_event', backend_bases._mouse_handler),\n            connect('motion_notify_event', backend_bases._mouse_handler),\n        ]\n\n        if figsize is None:\n            figsize = mpl.rcParams['figure.figsize']\n        if dpi is None:\n            dpi = mpl.rcParams['figure.dpi']\n        if facecolor is None:\n            facecolor = mpl.rcParams['figure.facecolor']\n        if edgecolor is None:\n            edgecolor = mpl.rcParams['figure.edgecolor']\n        if frameon is None:\n            frameon = mpl.rcParams['figure.frameon']\n\n        if not np.isfinite(figsize).all() or (np.array(figsize) < 0).any():\n            raise ValueError('figure size must be positive finite not '\n                             f'{figsize}')\n        self.bbox_inches = Bbox.from_bounds(0, 0, *figsize)\n\n        self.dpi_scale_trans = Affine2D().scale(dpi)\n        # do not use property as it will trigger\n        self._dpi = dpi\n        self.bbox = TransformedBbox(self.bbox_inches, self.dpi_scale_trans)\n        self.figbbox = self.bbox\n        self.transFigure = BboxTransformTo(self.bbox)\n        self.transSubfigure = self.transFigure\n\n        self.patch = Rectangle(\n            xy=(0, 0), width=1, height=1, visible=frameon,\n            facecolor=facecolor, edgecolor=edgecolor, linewidth=linewidth,\n            # Don't let the figure patch influence bbox calculation.\n            in_layout=False)\n        self._set_artist_props(self.patch)\n        self.patch.set_antialiased(False)\n\n        FigureCanvasBase(self)  # Set self.canvas.\n\n        if subplotpars is None:\n            subplotpars = SubplotParams()\n\n        self.subplotpars = subplotpars\n\n        self._axstack = _AxesStack()  # track all figure axes and current axes\n        self.clear()\n</code>\n\n\nFound 1 methods with name `set_constrained_layout` in file lib/matplotlib/figure.py.\nSearch result 1: <file>lib/matplotlib/figure.py</file> <class>Figure</class> <func>set_constrained_layout</func> <code>    def set_constrained_layout(self, constrained):\n        \"\"\"\n        [*Discouraged*] Set whether ``constrained_layout`` is used upon\n        drawing.\n\n        If None, :rc:`figure.constrained_layout.use` value will be used.\n\n        When providing a dict containing the keys ``w_pad``, ``h_pad``\n        the default ``constrained_layout`` paddings will be\n        overridden.  These pads are in inches and default to 3.0/72.0.\n        ``w_pad`` is the width padding and ``h_pad`` is the height padding.\n\n        .. admonition:: Discouraged\n\n            This method is discouraged in favor of `~.set_layout_engine`.\n\n        Parameters\n        ----------\n        constrained : bool or dict or None\n        \"\"\"\n        if constrained is None:\n            constrained = mpl.rcParams['figure.constrained_layout.use']\n        _constrained = bool(constrained)\n        _parameters = constrained if isinstance(constrained, dict) else {}\n        if _constrained:\n            self.set_layout_engine(ConstrainedLayoutEngine(**_parameters))\n        self.stale = True\n</code>\n\n\nFound 1 methods with name `set_layout_engine` in file lib/matplotlib/figure.py.\nSearch result 1: <file>lib/matplotlib/figure.py</file> <class>Figure</class> <func>set_layout_engine</func> <code>    def set_layout_engine(self, layout=None, **kwargs):\n        \"\"\"\n        Set the layout engine for this figure.\n\n        Parameters\n        ----------\n        layout: {'constrained', 'compressed', 'tight', 'none'} or \\\n`LayoutEngine` or None\n\n            - 'constrained' will use `~.ConstrainedLayoutEngine`\n            - 'compressed' will also use `~.ConstrainedLayoutEngine`, but with\n              a correction that attempts to make a good layout for fixed-aspect\n              ratio Axes.\n            - 'tight' uses `~.TightLayoutEngine`\n            - 'none' removes layout engine.\n\n            If `None`, the behavior is controlled by :rc:`figure.autolayout`\n            (which if `True` behaves as if 'tight' were passed) and\n            :rc:`figure.constrained_layout.use` (which if `True` behaves as if\n            'constrained' were passed).  If both are `True`,\n            :rc:`figure.autolayout` takes priority.\n\n            Users and libraries can define their own layout engines and pass\n            the instance directly as well.\n\n        kwargs: dict\n            The keyword arguments are passed to the layout engine to set things\n            like padding and margin sizes.  Only used if *layout* is a string.\n\n        \"\"\"\n        if layout is None:\n            if mpl.rcParams['figure.autolayout']:\n                layout = 'tight'\n            elif mpl.rcParams['figure.constrained_layout.use']:\n                layout = 'constrained'\n            else:\n                self._layout_engine = None\n                return\n        if layout == 'tight':\n            new_layout_engine = TightLayoutEngine(**kwargs)\n        elif layout == 'constrained':\n            new_layout_engine = ConstrainedLayoutEngine(**kwargs)\n        elif layout == 'compressed':\n            new_layout_engine = ConstrainedLayoutEngine(compress=True,\n                                                        **kwargs)\n        elif layout == 'none':\n            if self._layout_engine is not None:\n                new_layout_engine = PlaceHolderLayoutEngine(\n                    self._layout_engine.adjust_compatible,\n                    self._layout_engine.colorbar_gridspec\n                )\n            else:\n                new_layout_engine = None\n        elif isinstance(layout, LayoutEngine):\n            new_layout_engine = layout\n        else:\n            raise ValueError(f\"Invalid value for 'layout': {layout!r}\")\n\n        if self._check_layout_engines_compat(self._layout_engine,\n                                             new_layout_engine):\n            self._layout_engine = new_layout_engine\n        else:\n            raise RuntimeError('Colorbar layout of new layout engine not '\n                               'compatible with old engine, and a colorbar '\n                               'has been created.  Engine not changed.')\n</code>\n\n\n"
    }
]